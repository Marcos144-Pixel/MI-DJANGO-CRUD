<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV - Marcos Luis Campozano Mendoza</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh}
.gradient-text{background:linear-gradient(135deg,#6366f1,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.modal{display:none;position:fixed;z-index:100;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);overflow-y:auto}
.modal.active{display:flex;align-items:center;justify-content:center}
.floating{animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.btn-download{background:linear-gradient(135deg,#6366f1,#ec4899);transition:transform .2s}
.btn-download:hover{transform:scale(1.05)}
.btn-delete{background:#ef4444;color:white;padding:4px 12px;border-radius:9999px;font-size:.75rem;font-weight:bold;cursor:pointer;margin-left:8px;display:none}
.btn-delete:hover{background:#dc2626}
.btn-edit{background:#3b82f6;color:white;padding:4px 12px;border-radius:9999px;font-size:.75rem;font-weight:bold;cursor:pointer;margin-left:8px;display:none}
.btn-edit:hover{background:#2563eb}
.nav-link{padding:8px 16px;border-radius:9999px;font-size:.875rem;font-weight:600;transition:all .2s;cursor:pointer}
.nav-link:hover{background:#f3f4f6}
html{scroll-behavior:smooth}
.tab-btn{padding:12px 24px;border-radius:12px 12px 0 0;font-weight:700;cursor:pointer;transition:all .3s;border:2px solid white}
.tab-btn.active{background:white;color:#6366f1}
.tab-btn:not(.active){background:rgba(255,255,255,0.3);color:#1f2937}
.producto-card{background:#f0f9ff;padding:20px;border-radius:16px;border:2px solid #bfdbfe;transition:all .3s}
.producto-card:hover{transform:translateY(-5px);box-shadow:0 10px 25px rgba(0,0,0,0.1)}
.loading{text-align:center;padding:40px;color:#6366f1;font-size:18px}
@media print{body{background:white}header,.btn-delete,.btn-edit{display:none!important}.modal{display:none!important}}
</style>
</head>
<body>
<!-- Modal de Login/Registro -->
<div id="loginModal" class="modal active">
<div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full mx-4">
<div class="flex gap-2 mb-6">
<button onclick="mostrarTab('login')" id="tab-login" class="tab-btn active flex-1">üîê Iniciar Sesi√≥n</button>
<button onclick="mostrarTab('registro')" id="tab-registro" class="tab-btn flex-1">üìù Registrarse</button>
</div>

<!-- Tab Login -->
<div id="content-login" class="tab-content">
<h2 class="text-2xl font-black gradient-text mb-6 text-center">Acceso al Portafolio</h2>
<div class="mb-4">
<label class="block text-sm font-semibold mb-2">Usuario</label>
<input type="text" id="login-usuario" placeholder="Ingresa el usuario" class="w-full p-3 border rounded-lg">
</div>
<div class="mb-6">
<label class="block text-sm font-semibold mb-2">Contrase√±a</label>
<input type="password" id="login-password" placeholder="Ingresa la contrase√±a" class="w-full p-3 border rounded-lg" onkeypress="if(event.key==='Enter')iniciarSesion()">
</div>
<button onclick="iniciarSesion()" class="w-full btn-download text-white px-6 py-3 rounded-full font-bold mb-3">Iniciar Sesi√≥n</button>
<button onclick="entrarComoVisitante()" class="w-full px-6 py-3 border-2 border-gray-300 rounded-full font-bold hover:bg-gray-50">üëÅÔ∏è Entrar como Visitante</button>
</div>

<!-- Tab Registro -->
<div id="content-registro" class="tab-content" style="display:none">
<h2 class="text-2xl font-black gradient-text mb-6 text-center">Crear Cuenta</h2>
<div class="mb-4">
<label class="block text-sm font-semibold mb-2">Nombre Completo</label>
<input type="text" id="reg-nombre" placeholder="Ej: Juan P√©rez" class="w-full p-3 border rounded-lg">
</div>
<div class="mb-4">
<label class="block text-sm font-semibold mb-2">Usuario</label>
<input type="text" id="reg-usuario" placeholder="Elige un nombre de usuario" class="w-full p-3 border rounded-lg">
</div>
<div class="mb-4">
<label class="block text-sm font-semibold mb-2">Contrase√±a</label>
<input type="password" id="reg-password" placeholder="M√≠nimo 6 caracteres" class="w-full p-3 border rounded-lg">
</div>
<div class="mb-6">
<label class="block text-sm font-semibold mb-2">Confirmar Contrase√±a</label>
<input type="password" id="reg-password2" placeholder="Repite la contrase√±a" class="w-full p-3 border rounded-lg" onkeypress="if(event.key==='Enter')registrarUsuario()">
</div>
<button onclick="registrarUsuario()" class="w-full bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-full font-bold mb-3">üìù Crear Cuenta</button>
<button onclick="mostrarTab('login')" class="w-full px-6 py-3 border-2 border-gray-300 rounded-full font-bold hover:bg-gray-50">‚Üê Volver al Login</button>
</div>
</div>
</div>

<!-- Modal Login Visitante -->
<div id="visitanteModal" class="modal">
<div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full mx-4">
<h2 class="text-2xl font-black gradient-text mb-6 text-center">üîì Acceso como Visitante</h2>
<div class="mb-4">
<label class="block text-sm font-semibold mb-2">Nombre (opcional)</label>
<input type="text" id="visitante-nombre" placeholder="¬øC√≥mo te llamas?" class="w-full p-3 border rounded-lg">
</div>
<div class="mb-6">
<label class="block text-sm font-semibold mb-2">Email (opcional)</label>
<input type="email" id="visitante-email" placeholder="tu@email.com" class="w-full p-3 border rounded-lg" onkeypress="if(event.key==='Enter')confirmarVisitante()">
</div>
<button onclick="confirmarVisitante()" class="w-full btn-download text-white px-6 py-3 rounded-full font-bold mb-3">‚úÖ Continuar</button>
<button onclick="cancelarVisitante()" class="w-full px-6 py-3 border-2 border-gray-300 rounded-full font-bold hover:bg-gray-50">‚Üê Volver</button>
<p class="text-xs text-gray-400 mt-4 text-center">Como visitante solo podr√°s visualizar el contenido, sin opciones de edici√≥n</p>
</div>
</div>

<div id="filterModal" class="modal">
<div class="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
<h2 class="text-2xl font-black gradient-text mb-6">üñ®Ô∏è Seleccionar Secciones</h2>
<div class="space-y-3">
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-header" class="w-5 h-5" checked><span class="font-semibold">Info Personal</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-resumen" class="w-5 h-5" checked><span class="font-semibold">Resumen</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-experiencia" class="w-5 h-5" checked><span class="font-semibold">Experiencia</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-educacion" class="w-5 h-5" checked><span class="font-semibold">Educaci√≥n</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-habilidades" class="w-5 h-5" checked><span class="font-semibold">Habilidades</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-cursos" class="w-5 h-5" checked><span class="font-semibold">Cursos</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-reconocimientos" class="w-5 h-5" checked><span class="font-semibold">Reconocimientos</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-idiomas" class="w-5 h-5" checked><span class="font-semibold">Idiomas</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-productos-laborales" class="w-5 h-5" checked><span class="font-semibold">Productos Laborales</span></label>
<label class="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50"><input type="checkbox" id="filter-productos-academicos" class="w-5 h-5" checked><span class="font-semibold">Productos Acad√©micos</span></label>
</div>
<div class="mt-6 flex gap-3">
<button onclick="imprimir()" class="flex-1 btn-download text-white px-6 py-3 rounded-full font-bold">üñ®Ô∏è Imprimir</button>
<button onclick="closeFilterModal()" class="px-6 py-3 border-2 rounded-full font-bold">Cancelar</button>
</div></div></div>

<header class="sticky top-0 bg-white shadow-lg z-50">
<nav class="max-w-7xl mx-auto px-6 py-3">
<div class="flex items-center justify-between mb-2">
<div class="flex items-center gap-3">
<div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-pink-500 rounded-xl flex items-center justify-center text-white font-bold floating">MC</div>
<span class="font-black text-xl gradient-text">PORTAFOLIO</span>
<span id="usuario-nombre" class="text-sm text-gray-600 ml-2"></span>
</div>
<div class="flex items-center gap-3">
<button onclick="cerrarSesion()" class="px-4 py-2 border-2 border-red-500 text-red-600 rounded-full text-sm font-bold hover:bg-red-50" id="btn-logout" style="display:none">üö™ Salir</button>
<button onclick="openFilterModal()" class="btn-download text-white px-6 py-2.5 rounded-full text-sm font-bold">üñ®Ô∏è Imprimir</button>
</div>
</div>
<div class="flex flex-wrap gap-2 justify-center">
<a href="#section-resumen" class="nav-link">‚ú® Resumen</a>
<a href="#section-experiencia" class="nav-link">üíº Experiencia</a>
<a href="#section-educacion" class="nav-link">üéì Educaci√≥n</a>
<a href="#section-habilidades" class="nav-link">üíª Habilidades</a>
<a href="#section-cursos" class="nav-link">üìö Cursos</a>
<a href="#section-reconocimientos" class="nav-link">üèÜ Reconocimientos</a>
<a href="#section-idiomas" class="nav-link">üåç Idiomas</a>
<a href="#section-productos-laborales" class="nav-link">üíº Proyectos</a>
<a href="#section-productos-academicos" class="nav-link">üéì Acad√©mico</a>
</div>
</nav>
</header>

<main class="max-w-6xl mx-auto px-6 py-12" id="cv-content">
<div class="loading" id="loading">
<div class="text-4xl mb-4">‚è≥</div>
<p>Cargando datos desde la base de datos...</p>
</div>

<div id="main-content" style="display:none">
<div class="bg-white rounded-3xl shadow-2xl p-12 mb-8 text-center" id="section-header">
<div class="w-40 h-40 mx-auto rounded-3xl flex items-center justify-center border-4 border-white shadow-xl bg-gradient-to-br from-indigo-500 to-pink-500 mb-6">
<span class="text-6xl font-black text-white">MC</span>
</div>
<h1 class="text-5xl font-black mb-2">
<span class="gradient-text" id="display-apellidos">CAMPOZANO MENDOZA</span><br>
<span class="text-slate-900" id="display-nombres">MARCOS LUIS</span>
</h1>
<p class="text-lg text-slate-600 mb-4" id="display-titulo">Estudiante de Tecnolog√≠a de la Informaci√≥n</p>
<div class="flex flex-wrap justify-center gap-6 text-sm">
<span>üìß <span id="display-email">campozanomendoza@gmail.com</span></span>
<span>üì± <span id="display-telefono">+593 098 500 26 00</span></span>
<span>üìç <span id="display-ciudad">Jipijapa</span>, <span id="display-pais">Ecuador</span></span>
</div>
<div class="flex flex-wrap justify-center gap-6 text-sm mt-3">
<span>üéÇ <span id="display-edad"></span></span>
<span>üíç <span id="display-estado-civil">Soltero</span></span>
</div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-resumen">
<h2 class="text-2xl font-black mb-4 flex items-center gap-3">
<span class="text-3xl">‚ú®</span> Resumen Profesional
</h2>
<p class="text-xl text-slate-700 leading-relaxed">
Estudiante apasionado por la <span class="gradient-text font-bold">Tecnolog√≠a de la Informaci√≥n</span>, 
comprometido con el aprendizaje continuo y el desarrollo de soluciones innovadoras.
</p>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-experiencia">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üíº</span> Experiencia Laboral
</h2>
<div class="space-y-6" id="experiencia-list"></div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-educacion">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üéì</span> Educaci√≥n
</h2>
<div class="bg-purple-50 p-6 rounded-2xl border-2 border-purple-100">
<h3 class="font-bold text-lg mb-2">Tecnolog√≠a de la Informaci√≥n</h3>
<p class="text-purple-600 font-semibold mb-2">Universidad Laica Eloy Alfaro de Manab√≠ (ULEAM)</p>
<span class="px-3 py-1 bg-purple-500 text-white rounded-full text-xs font-bold">2022 - Presente</span>
</div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-habilidades">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üíª</span> Habilidades T√©cnicas
</h2>
<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
<div class="p-4 bg-indigo-50 rounded-xl text-center border-2 border-indigo-100">
<p class="font-bold">HTML & CSS</p>
<p class="text-xs text-indigo-600 mt-1">85%</p>
</div>
<div class="p-4 bg-indigo-50 rounded-xl text-center border-2 border-indigo-100">
<p class="font-bold">JavaScript</p>
<p class="text-xs text-indigo-600 mt-1">70%</p>
</div>
<div class="p-4 bg-indigo-50 rounded-xl text-center border-2 border-indigo-100">
<p class="font-bold">Git & GitHub</p>
<p class="text-xs text-indigo-600 mt-1">75%</p>
</div>
<div class="p-4 bg-indigo-50 rounded-xl text-center border-2 border-indigo-100">
<p class="font-bold">Python</p>
<p class="text-xs text-indigo-600 mt-1">65%</p>
</div>
</div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-cursos">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üìö</span> Cursos y Certificaciones
</h2>
<div class="space-y-4" id="cursos-list"></div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-reconocimientos">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üèÜ</span> Reconocimientos
</h2>
<div class="space-y-4" id="reconocimientos-list"></div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-idiomas">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üåç</span> Idiomas
</h2>
<div class="grid grid-cols-2 gap-4">
<div class="p-5 bg-rose-50 rounded-2xl border-2 border-rose-100">
<h3 class="font-bold mb-2">Espa√±ol</h3>
<span class="px-3 py-1 bg-rose-500 text-white rounded-full text-xs font-bold">Nativo - 100%</span>
</div>
<div class="p-5 bg-blue-50 rounded-2xl border-2 border-blue-100">
<h3 class="font-bold mb-2">Ingl√©s</h3>
<span class="px-3 py-1 bg-blue-500 text-white rounded-full text-xs font-bold">B√°sico - 40%</span>
</div>
</div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-productos-laborales">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üíº</span> Productos Laborales
</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="productos-laborales-list"></div>
</div>

<div class="bg-white rounded-3xl shadow-2xl p-8 mb-8" id="section-productos-academicos">
<h2 class="text-2xl font-black mb-6 flex items-center gap-3">
<span class="text-3xl">üéì</span> Productos Acad√©micos
</h2>
<div class="space-y-6" id="productos-academicos-list"></div>
</div>
</div>
</main>

<script>
// ========================================
// CONFIGURACI√ìN DE LA API
// ========================================
const API_URL = '/api/cv-completo/';

// Variables globales
let perfil = null;
let experiencias = [];
let cursos = [];
let reconocimientos = [];
let productosLaborales = [];
let productosAcademicos = [];

// Sistema de usuarios (localStorage para login)
let usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];

// Asegurar que el usuario admin siempre exista
if (!usuarios.find(u => u.usuario === 'admin')) {
  usuarios.push({usuario: 'admin', password: '1234', nombre: 'Administrador', tipo: 'admin'});
  localStorage.setItem('usuarios', JSON.stringify(usuarios));
}

let usuarioActual = null;

// ========================================
// FUNCIONES PARA CARGAR DATOS DESDE LA API
// ========================================

async function cargarDatosDesdeAPI() {
  try {
    const response = await fetch(API_URL);
    
    if (!response.ok) {
      throw new Error('Error al cargar los datos');
    }
    
    const data = await response.json();
    
    // Asignar datos a las variables globales
    perfil = data.perfil;
    experiencias = data.experiencias || [];
    cursos = data.cursos || [];
    reconocimientos = data.reconocimientos || [];
    productosLaborales = data.productos_laborales || [];
    productosAcademicos = data.productos_academicos || [];
    
    // Actualizar la interfaz
    actualizarDisplayPerfil();
    renderExperiencias();
    renderCursos();
    renderReconocimientos();
    renderProductosLaborales();
    renderProductosAcademicos();
    
    // Ocultar loading y mostrar contenido
    document.getElementById('loading').style.display = 'none';
    document.getElementById('main-content').style.display = 'block';
    
    console.log('‚úÖ Datos cargados correctamente desde la API');
    
  } catch (error) {
    console.error('‚ùå Error al cargar datos:', error);
    document.getElementById('loading').innerHTML = `
      <div class="text-4xl mb-4">‚ùå</div>
      <p class="text-red-600">Error al cargar los datos</p>
      <p class="text-sm text-gray-600 mt-2">${error.message}</p>
      <button onclick="cargarDatosDesdeAPI()" class="mt-4 px-6 py-2 bg-indigo-500 text-white rounded-full font-bold hover:bg-indigo-600">
        üîÑ Reintentar
      </button>
    `;
  }
}

// ========================================
// FUNCIONES DE UTILIDAD
// ========================================

function calcularEdad(fechaNacimiento) {
  if (!fechaNacimiento) return '';
  const hoy = new Date();
  const nacimiento = new Date(fechaNacimiento);
  let edad = hoy.getFullYear() - nacimiento.getFullYear();
  const mes = hoy.getMonth() - nacimiento.getMonth();
  if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) {
    edad--;
  }
  return edad + ' a√±os';
}

function formatFecha(f) {
  if (!f) return 'Presente';
  const d = new Date(f + 'T00:00:00');
  const m = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
  return m[d.getMonth()] + ' ' + d.getFullYear();
}

function ordenar(arr) {
  return arr.sort((a, b) => {
    const fA = a.inicio ? new Date(a.inicio) : new Date();
    const fB = b.inicio ? new Date(b.inicio) : new Date();
    return fB - fA;
  });
}

// ========================================
// FUNCIONES DE VISUALIZACI√ìN
// ========================================

function actualizarDisplayPerfil() {
  if (!perfil) return;
  
  document.getElementById('display-nombres').textContent = perfil.nombres || 'MARCOS LUIS';
  document.getElementById('display-apellidos').textContent = perfil.apellidos || 'CAMPOZANO MENDOZA';
  document.getElementById('display-titulo').textContent = perfil.titulo || 'Estudiante de Tecnolog√≠a de la Informaci√≥n';
  document.getElementById('display-email').textContent = perfil.email || 'campozanomendoza@gmail.com';
  document.getElementById('display-telefono').textContent = perfil.telefono || '+593 098 500 26 00';
  document.getElementById('display-ciudad').textContent = perfil.ciudad || 'Jipijapa';
  document.getElementById('display-pais').textContent = perfil.pais || 'Ecuador';
  document.getElementById('display-estado-civil').textContent = perfil.estado_civil || 'Soltero';
  document.getElementById('display-edad').textContent = calcularEdad(perfil.fecha_nacimiento);
}

function renderExperiencias() {
  const l = document.getElementById('experiencia-list');
  
  if (experiencias.length === 0) {
    l.innerHTML = '<p class="text-gray-500 italic">No hay experiencias laborales registradas.</p>';
    return;
  }
  
  l.innerHTML = '';
  ordenar(experiencias).forEach((e) => {
    l.innerHTML += `
      <div class="bg-indigo-50 p-6 rounded-2xl border-2 border-indigo-100">
        <div class="flex justify-between items-start mb-3">
          <h3 class="font-bold text-xl">${e.puesto}</h3>
          <span class="px-3 py-1 bg-indigo-500 text-white rounded-full text-xs font-bold whitespace-nowrap">
            ${formatFecha(e.inicio)} - ${formatFecha(e.fin)}
          </span>
        </div>
        <p class="text-indigo-600 font-semibold mb-3">${e.empresa}</p>
        <p class="text-slate-600">${e.descripcion}</p>
      </div>
    `;
  });
}

function renderCursos() {
  const l = document.getElementById('cursos-list');
  
  if (cursos.length === 0) {
    l.innerHTML = '<p class="text-gray-500 italic">No hay cursos registrados.</p>';
    return;
  }
  
  l.innerHTML = '';
  ordenar(cursos).forEach((c) => {
    const img = c.imagen ? `<img src="${c.imagen}" alt="${c.nombre}" class="w-full h-32 object-cover rounded-lg mb-3">` : '';
    l.innerHTML += `
      <div class="bg-green-50 p-5 rounded-2xl border-2 border-green-100">
        <div class="flex justify-between items-start gap-4">
          <div class="flex-1">
            ${img}
            <h3 class="font-bold">${c.nombre}</h3>
            <p class="text-green-600 font-semibold text-sm">${c.institucion}</p>
            <p class="text-xs text-slate-500">${formatFecha(c.inicio)} ‚Ä¢ ${c.duracion}</p>
          </div>
        </div>
      </div>
    `;
  });
}

function renderReconocimientos() {
  const l = document.getElementById('reconocimientos-list');
  
  if (reconocimientos.length === 0) {
    l.innerHTML = '<p class="text-gray-500 italic">No hay reconocimientos registrados.</p>';
    return;
  }
  
  l.innerHTML = '';
  ordenar(reconocimientos).forEach((r) => {
    const img = r.imagen ? `<img src="${r.imagen}" alt="${r.titulo}" class="w-full h-32 object-cover rounded-lg mb-3">` : '';
    l.innerHTML += `
      <div class="bg-yellow-50 p-5 rounded-2xl border-2 border-yellow-100">
        <div class="flex justify-between items-start mb-3">
          ${img}
          <div class="flex-1">
            <h3 class="font-bold">${r.titulo}</h3>
            <p class="text-yellow-600 font-semibold text-sm">${r.otorgado_por}</p>
            <p class="text-xs text-slate-500 mb-2">${formatFecha(r.fecha)}</p>
            <p class="text-sm text-slate-600">${r.descripcion}</p>
          </div>
        </div>
      </div>
    `;
  });
}

function renderProductosLaborales() {
  const l = document.getElementById('productos-laborales-list');
  
  if (productosLaborales.length === 0) {
    l.innerHTML = '<p class="text-gray-500 italic col-span-2">No hay productos laborales registrados.</p>';
    return;
  }
  
  l.innerHTML = '';
  ordenar(productosLaborales).forEach((p) => {
    const img = p.imagen ? `<img src="${p.imagen}" alt="${p.nombre}" class="w-full h-48 object-cover rounded-lg mb-4">` : '<div class="w-full h-48 bg-gradient-to-br from-cyan-200 to-blue-300 rounded-lg mb-4 flex items-center justify-center"><span class="text-4xl">üíª</span></div>';
    const url = p.url ? `<a href="${p.url}" target="_blank" class="text-cyan-600 hover:underline text-sm">üîó Ver proyecto</a>` : '';
    
    l.innerHTML += `
      <div class="producto-card">
        ${img}
        <div class="flex justify-between items-start mb-3">
          <h3 class="font-bold text-lg flex-1">${p.nombre}</h3>
        </div>
        <p class="text-cyan-600 font-semibold mb-2">${p.empresa}</p>
        <span class="px-3 py-1 bg-cyan-500 text-white rounded-full text-xs font-bold">
          ${formatFecha(p.inicio)} - ${formatFecha(p.fin)}
        </span>
        <p class="text-sm text-slate-600 mt-3 mb-2">${p.descripcion}</p>
        <p class="text-xs text-slate-500 mb-2"><strong>Rol:</strong> ${p.rol}</p>
        <p class="text-xs text-slate-500 mb-2"><strong>Tecnolog√≠as:</strong> ${p.tecnologias}</p>
        ${url}
      </div>
    `;
  });
}

function renderProductosAcademicos() {
  const l = document.getElementById('productos-academicos-list');
  
  if (productosAcademicos.length === 0) {
    l.innerHTML = '<p class="text-gray-500 italic">No hay productos acad√©micos registrados.</p>';
    return;
  }
  
  l.innerHTML = '';
  ordenar(productosAcademicos).forEach((p) => {
    const img = p.imagen ? `<img src="${p.imagen}" alt="${p.titulo}" class="w-full h-40 object-cover rounded-lg mb-3">` : '';
    const url = p.url ? `<a href="${p.url}" target="_blank" class="text-purple-600 hover:underline text-sm mt-2 inline-block">üîó Ver publicaci√≥n</a>` : '';
    
    l.innerHTML += `
      <div class="bg-purple-50 p-6 rounded-2xl border-2 border-purple-100">
        ${img}
        <div class="flex justify-between items-start mb-3">
          <div class="flex-1">
            <span class="px-3 py-1 bg-purple-500 text-white rounded-full text-xs font-bold">${p.tipo}</span>
            <h3 class="font-bold text-lg mt-2">${p.titulo}</h3>
            <p class="text-purple-600 font-semibold text-sm">${p.institucion}</p>
            <p class="text-xs text-slate-500">${formatFecha(p.fecha)}</p>
          </div>
        </div>
        <p class="text-sm text-slate-600 mb-2"><strong>Autores:</strong> ${p.autores}</p>
        <p class="text-sm text-slate-700 mb-2">${p.resumen}</p>
        <p class="text-xs text-purple-500"><strong>Palabras clave:</strong> ${p.palabras_clave}</p>
        ${url}
      </div>
    `;
  });
}

// ========================================
// SISTEMA DE LOGIN
// ========================================

function guardarUsuarios() {
  localStorage.setItem('usuarios', JSON.stringify(usuarios));
}

function mostrarTab(tab) {
  document.getElementById('tab-login').classList.remove('active');
  document.getElementById('tab-registro').classList.remove('active');
  document.getElementById('content-login').style.display = 'none';
  document.getElementById('content-registro').style.display = 'none';
  
  if (tab === 'login') {
    document.getElementById('tab-login').classList.add('active');
    document.getElementById('content-login').style.display = 'block';
  } else {
    document.getElementById('tab-registro').classList.add('active');
    document.getElementById('content-registro').style.display = 'block';
  }
}

function registrarUsuario() {
  const nombre = document.getElementById('reg-nombre').value.trim();
  const usuario = document.getElementById('reg-usuario').value.trim();
  const password = document.getElementById('reg-password').value;
  const password2 = document.getElementById('reg-password2').value;
  
  if (!nombre || !usuario || !password || !password2) {
    alert('‚ùå Completa todos los campos');
    return;
  }
  
  if (password.length < 6) {
    alert('‚ùå La contrase√±a debe tener al menos 6 caracteres');
    return;
  }
  
  if (password !== password2) {
    alert('‚ùå Las contrase√±as no coinciden');
    return;
  }
  
  if (usuarios.find(u => u.usuario === usuario)) {
    alert('‚ùå El nombre de usuario ya existe');
    return;
  }
  
  usuarios.push({
    usuario: usuario,
    password: password,
    nombre: nombre,
    tipo: 'comun'
  });
  
  guardarUsuarios();
  alert('‚úÖ Cuenta creada exitosamente. Ya puedes iniciar sesi√≥n.');
  
  document.getElementById('reg-nombre').value = '';
  document.getElementById('reg-usuario').value = '';
  document.getElementById('reg-password').value = '';
  document.getElementById('reg-password2').value = '';
  
  mostrarTab('login');
}

function iniciarSesion() {
  const usuario = document.getElementById('login-usuario').value.trim();
  const password = document.getElementById('login-password').value;
  
  const user = usuarios.find(u => u.usuario === usuario && u.password === password);
  
  if (user) {
    usuarioActual = user;
    document.getElementById('loginModal').classList.remove('active');
    document.getElementById('btn-logout').style.display = 'inline-block';
    document.getElementById('usuario-nombre').textContent = `üë§ ${user.nombre}`;
    
    alert('‚úÖ Bienvenido ' + user.nombre);
    
    document.getElementById('login-usuario').value = '';
    document.getElementById('login-password').value = '';
  } else {
    alert('‚ùå Usuario o contrase√±a incorrectos');
  }
}

function cerrarSesion() {
  if (confirm('¬øCerrar sesi√≥n?')) {
    usuarioActual = null;
    document.getElementById('btn-logout').style.display = 'none';
    document.getElementById('usuario-nombre').textContent = '';
    document.getElementById('loginModal').classList.add('active');
    mostrarTab('login');
    alert('üëã Sesi√≥n cerrada');
  }
}

function entrarComoVisitante() {
  document.getElementById('loginModal').classList.remove('active');
  document.getElementById('visitanteModal').classList.add('active');
}

function confirmarVisitante() {
  const nombre = document.getElementById('visitante-nombre').value.trim() || 'Visitante';
  usuarioActual = {
    usuario: 'visitante',
    nombre: nombre,
    tipo: 'visitante'
  };
  
  document.getElementById('visitanteModal').classList.remove('active');
  document.getElementById('usuario-nombre').textContent = `üëÅÔ∏è ${nombre}`;
  document.getElementById('btn-logout').style.display = 'inline-block';
  document.getElementById('visitante-nombre').value = '';
  document.getElementById('visitante-email').value = '';
  alert('üëÅÔ∏è Bienvenido como visitante');
}

function cancelarVisitante() {
  document.getElementById('visitanteModal').classList.remove('active');
  document.getElementById('loginModal').classList.add('active');
}

// ========================================
// FUNCIONES DE MODAL
// ========================================

function openFilterModal() {
  document.getElementById('filterModal').classList.add('active');
}

function closeFilterModal() {
  document.getElementById('filterModal').classList.remove('active');
}

function imprimir() {
  const s = ['header', 'resumen', 'experiencia', 'educacion', 'habilidades', 'cursos', 'reconocimientos', 'idiomas', 'productos-laborales', 'productos-academicos'];
  const h = document.querySelector('header');
  
  if (h) h.style.display = 'none';
  
  s.forEach(sec => {
    const e = document.getElementById('section-' + sec);
    const c = document.getElementById('filter-' + sec);
    if (e && c) e.style.display = c.checked ? 'block' : 'none';
  });
  
  closeFilterModal();
  
  setTimeout(() => {
    window.print();
    setTimeout(() => {
      s.forEach(sec => {
        const e = document.getElementById('section-' + sec);
        if (e) e.style.display = 'block';
      });
      if (h) h.style.display = 'block';
    }, 100);
  }, 300);
}

// ========================================
// INICIALIZACI√ìN
// ========================================

// Cargar datos cuando la p√°gina termine de cargar
window.addEventListener('DOMContentLoaded', () => {
  cargarDatosDesdeAPI();
});
</script>
</body>
</html>